{
  "program": "router.p4",
  "language": "p4-14",
  "targets": {
    "multiswitch": {
      "bmv2_log": true,
      "pcap_dump": true,
      "auto-control-plane": true,
      "cli": false,
      "links": [["h1", "s1"], ["h2", "s1"], ["h3", "s1"], ["h9", "s1"]],
      "parameters": {
          "LD_PRELOAD": "./src/netkafka_hooks.so",
          "LD_LIBRARY_PATH": "./"
      },
      "_hosts": {
        "h1": {
            "cmd": "./rdkafka_performance -C -t 03 -p 0 -o end",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h2": {
            "cmd": "./rdkafka_performance -C -t 03 -p 0 -o end",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h3": {
            "cmd": "./rdkafka_performance -C -t 03 -p 0 -o end",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h9": {
            "cmd": "./rdkafka_performance -P -s 1024 -t 01 -r 500 -x 2000 -S 0",
            "wait": true
        }
      },
      "hosts": {
        "h1": {
            "cmd": "./consumer.py 1234",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h2": {
            "cmd": "./consumer.py 1234",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h3": {
            "cmd": "./consumer.py 1234",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h9": {
            "cmd": "./producer.py -b h9 -r 2000 -t 5 01 255.255.255.255 1234",
            "wait": true
        }
      },
      "_test_hosts": {
        "h1": {
            "cmd": "./recv.py 1234",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h2": {
            "cmd": "./recv.py 1234",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h3": {
            "cmd": "./recv.py 1234",
            "startup_sleep": 0.2,
            "wait": false
        },
        "h9": {
            "cmd": "./send.py 1 255.255.255.255 1234",
            "wait": true
        }
      },
      "switches": {
          "s1": {
              "entries": "commands.txt"
          }
      }
    }
  }
}
